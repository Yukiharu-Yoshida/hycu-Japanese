.. _reporting:

----------------
HYCU: レポーティング
----------------

*この演習の推定所要時間は60分です。*

概要
++++++++
HYCUのユニークで強力なレポート機能は、HYCU Controller VMで実行され、追加のインフラストラクチャを必要としません。これは、HYCUの基本ライセンスに含まれる標準的な機能です。スケジューリング、さまざまな形式での配信、アドホックエクスポートなど、レポートツールで期待されるすべての基本オプションを提供します。加えて、HYCUの内部データベースのほぼすべてのフィールドをデータフィルタリング、時間選択、さまざまなレポートタイプと組み合わせて使用することで、顧客レポートを作成するという驚くべき柔軟性を提供します。では、これらの各オプションについて見ていきましょう。

#. 管理者としてログインします。左側パネル > *Reports*に進みます。

.. figure:: images/1.png

Reportsをクリックすると、既定ですぐに使用できるバックアップレポートが表示されます。任意のレポートを選択してPreviewボタン |preview| をクリックすると、任意のレポートの出力を表示できます。この演習では、最も一般的に使用されるバックアップレポート“VM backup status”レポートをプレビューしてみましょう。
このレポートは、過去24時間のすべてのVMのバックアップステータスの詳細を表示します。

.. |preview| image:: images/2.png

.. figure:: images/3.png

ご覧のとおり、このレポートには次の重要な項目が含まれます：
   - VM name
   - Backup completion status （バックアップ成功の場合はOK、バックアップ失敗の場合はFATAL）
   - Backup type （フルバックアップまたは増分バックアップ）
   - Backup policy
   - Backup duration with start time and end time（開始時刻と終了時刻を含むバックアップ期間）
   - Amount of data transferred（転送されたデータ量）


小さなダウンロードアイコン |download-icon| をクリックすると、このレポートをエクスポートできます。これにより、レポートをエクスポートするための次のオプションが表示されます。

.. |download-icon| image:: images/4.png

.. figure:: images/5.png

要件に合わせたレポートを作成する最も簡単な方法は、既存のレポートを編集することです。例えば、同じ“VM backup status”レポートを見てみましょう。
そのレポートを編集し、バックアップされたVMの詳細な情報を含めることができます。24時間ではなく、先週のレポートを取得しましょう。 *Reports*から“*VM backup status*”レポートをクリックし、 *Edit*ボタンをクリックします。

これにより、レポートの表示が少し変わります。左側には、HYCUメタデータ情報のほとんどが表示され、X軸またはY軸にドラッグアンドドロップしてレポートに使用できます。

.. figure:: images/6.png

ここで、レポートタグプール（左側）から次のフィールドをY-AXISタグにドラッグアンドドロップし、レポートに項目を追加します：
   - “Avg Change Rate” -> 右側の“Job duration” と “Size of backed up data” フィールドの間
      - これは、バックアップ間のデータ変更率を提供します。
   - “Compliancy Status” -> 右側の“Status” と “Backup Type” フィールドの間
      - これにより、バックアップジョブが時間どおりに完了したかどうかに関する情報が提供されます。バックアップジョブが正常に完了した場合でも、コンプライアンスステータスが失敗（ステータスが赤）になることがあります。
   - “Owner” -> 右側の“VM name” フィールドの下
      - これにより、任意のVMのバックアップに対する明示的な権限を持つHYCUユーザーグループが提供されます。これは、セルフサービスセクションを直接参照しています。
   - “Target name” -> 最後に
      - これにより、任意のVMのバックアップターゲットの場所が提供されます。バックアップターゲット情報の詳細を示す別のレポートがあります。

フィールドの追加が完了すると、Y-AXISタグは次のようになります：

.. figure:: images/7.png

上の行のドロップダウンから、24時間ではなく1週間の時間を選択し、画面の左上にあるレポートの名前を変更して、新しいレポートを作成します。

.. figure:: images/8.png

画面右上の “*Save As*”をクリックして、新しく作成したレポートを保存します。

保存したレポートは、 *Reports*セクションに表示されます。 *Generate*をクリックして、HYCUのレポートデータベースにある現在のHYCUデータを使用して、正確な時間にレポートを生成します。HYCUのレポートデータベースは、12時間ごとにメインデータベースと同期しています。

HYCUを使用すると、バックアップレポートを定期的にスケジュールして、一連の履歴レポートを生成し、一定期間にわたる製品の傾向を得ることができます。レポートのデータを失わないようにするために、レポートスケジュールがHYCUポリシーで設定された最短保持期間よりも短いことを確認してください。

新しく作成したレポート “*VM backup status detailed*”をクリックし、 *Scheduler*をクリックします。

.. figure:: images/9.png

IntervalドロップダウンからDailyを選択し、“*SEND*”トグルスイッチを有効にします。

.. figure:: images/10.png

これにより、PDF、PNG、またはCSV形式で生成されたレポートを電子メールで送信できます。目的のメールアドレスを指定し、 *Schedule*をクリックします。レポートを電子メールで送信するには、HYCU管理メニューからSMTPを設定する必要があります。

複数のHYCU Controllerがある場合、またはカスタムレポートをコミュニティと共有したい場合は、お気に入りのバックアップレポートをエクスポートおよびインポートすることもできます。例えば、新しく作成したレポート“*VM backup status detailed*”を別のHYCU Controllerで使用する場合は、次の手順を実行する必要があります：

- 送信元のHYCU backup controller：
  - Reportsに移動
  - “VM backup status detailed”レポートをクリックし、 画面の左上にある “Export”をクリックします。これにより、レポート構成がJSON形式でエクスポートされ、ローカルのコンピューターにダウンロードされます。
- 送信先のHYCU backup controller：
  - Reportsに移動
  - “import”ボタンをクリック

  .. figure:: images/11.png

  - “*Browse*”ボタンをクリックし、送信元から新しくインポートされたJSONファイルを追加します：

  .. figure:: images/12.png

- ご覧のとおり、HYCUは名前とレポートの説明を自動的に入力するため、インポートするレポートを認識できます。
- “*Import*”ボタンをクリックし、レポートをインポートします。

HYCUは、正確な要件に合わせて新しいカスタムレポートを作成する際にも役立ちます。既存のレポートの編集とは異なり、この演習では、まったく新しいレポートをゼロから作成します。

Report 1 – ソース毎のターゲット使用率
========================================

このレポートでは、バックアップソース（ハイパーバイザー、Nutanix Files、物理ホストを含む）からバックアップターゲットの利用状況に関するハイレベルの情報を作成します。

- *Reports*に移動
- *New*をクリック
  - これにより、レポートスキーマ全体が表示されます。
- X-AXISタグとY-AXISタグをクリアします。
  - 以下に示すように、Clearボタンをクリックします。

  .. figure:: images/13.png

  .. figure:: images/14.png

  .. figure:: images/15.png

- Report typeの下で、“Stacked bar chart”を選択します。
- X-AXISタグで“Target Name”を選択し、Y-AXISタグで“source Name”を選択します。
- これは、最終レポートがどのようになるかを示しています：

.. figure:: images/16.png

- レポートの *NAME*フィールドに名前を入力し、 *Save*をクリックします。

Report 2 – 特定のユーザーグループのターゲットあたりのVMバックアップサイズ
============================================================

このレポートは、VMバックアップのターゲット使用率をグラフィカルビューで提供することです。より面白くするために、単一のHYCUテナントユーザーグループのレポートを作成します。これは、顧客の1人がどのようにターゲットを利用しているのか確認する方法を探しているサービスプロバイダーに最適であり、この上で請求の仕組みを構成する可能性があります。

- Reportsに移動
  -  *New*をクリック
  - これにより、レポートスキーマ全体が表示されます。
- SX-AXISタグとY-AXISタグをクリアします。
  - 以下に示すように、Clearボタンをクリックします。

  .. figure:: images/13.png

  .. figure:: images/14.png

  .. figure:: images/15.png

- Report typeの下で、“Horizontal Stacked bar chart”を選択します。
- X-AXISタグで“VM Name”と“Size of Backed up Data”を選択し、Y-AXISタグで“Target Name”と“Owner”を選択します。
- Y-AXIS TAGSタグでOwnerドロップダウンを選択し、1つのUser Groupを選択します。
- これは、最終レポートがどのようになるかを示しています：

  .. figure:: images/17.png

- レポートの *NAME*フィールドに名前を入力し、 *Save*をクリックします。
